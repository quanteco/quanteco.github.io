<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en-US" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang="en-US" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en-US" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns#"> <!--<![endif]-->
<head>
<base href="http://quanteco.github.io." />

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Moran&#039;s I (Calculation and Testing) -</title>

<!-- This site is optimized with the Yoast SEO plugin v3.0.7 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Moran&#039;s I (Calculation and Testing) -" />
<meta property="og:description" content="In tandem with the previous post, this blog post will focus on calculating Moran’s I and testing for autocorrelation. Moran&#8217;s I is a value that represents the degree of autocorrelation in a vector () given a weight matrix () or &hellip; Continued" />
<meta property="og:url" content="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/" />
<meta property="article:tag" content="autocorrelation" />
<meta property="article:tag" content="dbmem" />
<meta property="article:tag" content="mem" />
<meta property="article:tag" content="Moran&#039;s I" />
<meta property="article:section" content="R" />
<meta property="article:published_time" content="2015-12-29T12:00:16+00:00" />
<meta property="article:modified_time" content="2016-01-14T17:37:03+00:00" />
<meta property="og:updated_time" content="2016-01-14T17:37:03+00:00" />
<meta property="og:image" content="http://quanteco.github.io./wp-content/uploads/2015/01/moransi.png" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="In tandem with the previous post, this blog post will focus on calculating Moran’s I and testing for autocorrelation. Moran&#8217;s I is a value that represents the degree of autocorrelation in a vector () given a weight matrix () or &hellip; Continued"/>
<meta name="twitter:title" content="Moran&#039;s I (Calculation and Testing) -"/>
<meta name="twitter:image" content="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/moransi.png?fit=600%2C600"/>
<!-- / Yoast SEO plugin. -->




		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/gregorybanderson.elementfx.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.2"}};
			!function(a,b,c){function d(a){var c,d=b.createElement("canvas"),e=d.getContext&&d.getContext("2d"),f=String.fromCharCode;return e&&e.fillText?(e.textBaseline="top",e.font="600 32px Arial","flag"===a?(e.fillText(f(55356,56806,55356,56826),0,0),d.toDataURL().length>3e3):"diversity"===a?(e.fillText(f(55356,57221),0,0),c=e.getImageData(16,16,1,1).data.toString(),e.fillText(f(55356,57221,55356,57343),0,0),c!==e.getImageData(16,16,1,1).data.toString()):("simple"===a?e.fillText(f(55357,56835),0,0):e.fillText(f(55356,57135),0,0),0!==e.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='rb-font-awesome-css'  href='//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.4.0' type='text/css' media='all' />
<link rel='stylesheet' id='rb-styles-css'  href='http://quanteco.github.io./wp-content/plugins/resume-builder/css/resume-builder-styles.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='easy_table_style-css'  href='http://quanteco.github.io./wp-content/plugins/easy-table/themes/default/style.css?ver=1.5.3' type='text/css' media='all' />
<link rel='stylesheet' id='wp-github-css'  href='http://quanteco.github.io./wp-content/plugins/wp-github/css/wp-github.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='kadence_theme-css'  href='http://quanteco.github.io./wp-content/themes/virtue/assets/css/virtue.css?ver=262' type='text/css' media='all' />
<link rel='stylesheet' id='virtue_skin-css'  href='http://quanteco.github.io./wp-content/themes/virtue/assets/css/skins/default.css' type='text/css' media='all' />
<link rel='stylesheet' id='redux-google-fonts-virtue-css'  href='http://fonts.googleapis.com/css?family=Lato%3A400&#038;ver=1452092672' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='http://quanteco.github.io./wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css?ver=3.1' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='http://quanteco.github.io./wp-content/plugins/jetpack/css/jetpack.css?ver=3.8.2' type='text/css' media='all' />
<script type='text/javascript' src='http://quanteco.github.io./wp-includes/js/jquery/jquery.js?ver=1.11.3'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/jetpack/modules/related-posts/related-posts.js?ver=20150408'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/alphanum.js?ver=1.0'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/chosen/chosen.js?ver=1.1.0'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/context/contextmenu.js?ver=3.9.6.1'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/footable.js?ver=2.0.1.2'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/filertify.js?ver=0.3.11'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/soundmanager2.js?ver=2.97a.20130101'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var fileaway_mgmt = {"ajaxurl":"http:\/\/gregorybanderson.elementfx.com\/wp-admin\/admin-ajax.php","nonce":"a3724cfb43","device":"desktop","no_results":"Nothing found.","cancel_link":"Cancel","save_link":"Save","proceed_link":"Proceed","delete_check":"Delete?","ok_label":"OK","confirm_label":"I'm Sure","cancel_label":"Nevermind","file_singular":"file","file_plural":"files","delete_confirm":"You are about to permanently delete numfiles. Are you sure you're OK with that?","tamper1":"Sorry, there was a problem verifying the correct path to the files.","tamper2":"There was an error completing your request. The path to the directory has not been properly defined.","tamper3":"Sorry, but the name you specified cannot be processed.","tamper4":"An error has been triggered.","no_files_selected":"No files have been selected. Click on the table rows of the files you wish to select.","no_files_chosen":"No files have been chosen.","no_action":"No action has been selected.","no_destination":"No destination directory has been selected.","no_subdir_name":"You did not specify a name for your sub-directory.","unreadable_file":"Sorry, a file you have specified could not be read.","build_path":"Please build the path to your destination directory.","no_upload_support":"Your browser does not support the File Upload API. Please update.","exceeds_size":"This file exceeds the prettymax max file size.","type_not_permitted":"This file type is not permitted.","view_all_permitted":"View all permitted file types.","view_all_prohibited":"View all prohibited file types.","double_dots_override":"You may not use double dots or attempt to override the upload directory.","double_dots":"You may not use double dots in the filename.","creation_disabled":"Sub-directory creation is disabled.","no_override":"You may not attempt to override the upload directory.","multi_type":"You may not specify a script filetype prior to a non-script filetype.","upload_failure":"Sorry about that, but filename could not be uploaded.","rename_column":"Rename Column","delete_column":"Delete Column","insert_col_before":"Insert New Column Before","insert_col_after":"Insert New Column After","insert_row":"Insert New Row","delete_row":"Delete Row","save_backup":"Save Backup","new_column_name":"New Column Name","atleast_one_column":"There must be at least one column at all times.","atleast_one_row":"There must be at least one row at all times.","next_label":"Next","create_label":"Create","new_file_name":"New File Name","specify_file_name":"You must specify a file name.","specify_column_name":"You must specify at least one column name.","column_names":"Column Names, Comma-separated"};
/* ]]> */
</script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/management.js?ver=3.9.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var fileaway_stats = {"ajaxurl":"http:\/\/gregorybanderson.elementfx.com\/wp-admin\/admin-ajax.php","nonce":"df9230aaac"};
/* ]]> */
</script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/file-away/lib/js/stats.js?ver=3.9.6.1'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/themes/virtue/assets/js/vendor/modernizr.min.js'></script>
<link rel='https://api.w.org/' href='http://quanteco.github.io./wp-json/' />

 

<link rel='shortlink' href='http://wp.me/p765Dr-Z' />


<script> var fileaway_filetype_groups = {'adobe' : ['abf', 'aep', 'afm', 'ai', 'as', 'eps', 'fla', 'flv', 'fm', 'indd', 'pdd', 'pdf', 'pmd', 'ppj', 'prc', 'ps', 'psb', 'psd', 'swf'], 'application' : ['bat', 'dll', 'exe', 'msi'], 'audio' : ['aac', 'aif', 'aifc', 'aiff', 'amr', 'ape', 'au', 'bwf', 'flac', 'iff', 'gsm', 'la', 'm4a', 'm4b', 'm4p', 'mid', 'mp2', 'mp3', 'mpc', 'ogg', 'ots', 'ram', 'raw', 'rex', 'rx2', 'spx', 'swa', 'tta', 'vox', 'wav', 'wma', 'wv'], 'compression' : ['7z', 'a', 'ace', 'afa', 'ar', 'bz2', 'cab', 'cfs', 'cpio', 'cpt', 'dar', 'dd', 'dmg', 'gz', 'lz', 'lzma', 'lzo', 'mar', 'rar', 'rz', 's7z', 'sda', 'sfark', 'shar', 'tar', 'tgz', 'xz', 'z', 'zip', 'zipx', 'zz'], 'css' : ['css', 'less', 'sass', 'scss'], 'image' : ['bmp', 'dds', 'exif', 'gif', 'hdp', 'hdr', 'iff', 'jfif', 'jpeg', 'jpg', 'jxr', 'pam', 'pbm', 'pfm', 'pgm', 'png', 'pnm', 'ppm', 'raw', 'rgbe', 'tga', 'thm', 'tif', 'tiff', 'webp', 'wdp', 'yuv'], 'msdoc' : ['doc', 'docm', 'docx', 'dot', 'dotx'], 'msexcel' : ['xls', 'xlsm', 'xlsb', 'xlsx', 'xlt', 'xltm', 'xltx', 'xlw'], 'openoffice' : ['dbf', 'dbf4', 'odp', 'ods', 'odt', 'stc', 'sti', 'stw', 'sxc', 'sxi', 'sxw'], 'powerpoint' : ['pot', 'potm', 'potx', 'pps', 'ppt', 'pptm', 'pptx', 'pub'], 'script' : ['asp', 'cfm', 'cgi', 'clas', 'class', 'cpp', 'htm', 'html', 'java', 'js', 'php', 'pl', 'py', 'rb', 'shtm', 'shtml', 'xhtm', 'xhtml', 'xml', 'yml'], 'text' : ['123', 'csv', 'log', 'psw', 'rtf', 'sql', 'txt', 'uof', 'uot', 'wk1', 'wks', 'wpd', 'wps'], 'video' : ['avi', 'divx', 'mov', 'm4p', 'm4v', 'mkv', 'mp4', 'mpeg', 'mpg', 'ogv', 'qt', 'rm', 'rmvb', 'vob', 'webm', 'wmv']}; var ssfa_filetype_icons = {'adobe' : '&#x21;', 'application' : '&#x54;', 'audio' : '&#x43;', 'compression' : '&#x27;', 'css' : '&#x28;', 'image' : '&#x31;', 'msdoc' : '&#x23;', 'msexcel' : '&#x24;', 'openoffice' : '&#x22;', 'powerpoint' : '&#x26;', 'script' : '&#x25;', 'text' : '&#x2e;', 'video' : '&#x57;', 'unknown' : '&#x29;'} </script>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<style type='text/css'>img#wpstats{display:none}</style><style type="text/css">#logo {padding-top:0px;}#logo {padding-bottom:0px;}#logo {margin-left:0px;}#logo {margin-right:0px;}#nav-main {margin-top:0px;}#nav-main {margin-bottom:0px;}.headerfont, .tp-caption {font-family:'Palatino Linotype', 'Book Antiqua', Palatino, serif;} 
  .topbarmenu ul li {font-family:Lato;}
  #kadbreadcrumbs {font-family:'MS Serif', 'New York', sans-serif;}input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; } input[type=number] {-moz-appearance: textfield;}.quantity input::-webkit-outer-spin-button,.quantity input::-webkit-inner-spin-button {display: none;}.product_item .product_details h5 {text-transform: none;}.product_item .product_details h5 {min-height:40px;}</style><!--[if lt IE 9]>
<script src="http://quanteco.github.io./wp-content/themes/virtue/assets/js/vendor/respond.min.js"></script>
<![endif]-->
<style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="icon" href="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/cropped-iconga-54b80e4ev1_site_icon.png?fit=32%2C32" sizes="32x32" />
<link rel="icon" href="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/cropped-iconga-54b80e4ev1_site_icon.png?fit=192%2C192" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/cropped-iconga-54b80e4ev1_site_icon.png?fit=180%2C180" />
<meta name="msapplication-TileImage" content="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/cropped-iconga-54b80e4ev1_site_icon.png?fit=270%2C270" />
<style type="text/css" title="dynamic-css" class="options-output">header #logo a.brand,.logofont{font-family:Lato;line-height:40px;font-weight:400;font-style:normal;font-size:32px;}.kad_tagline{font-family:Lato;line-height:20px;font-weight:400;font-style:normal;color:#444444;font-size:14px;}.product_item .product_details h5{font-family:Lato;line-height:20px;font-weight:normal;font-style:700;font-size:16px;}h1{font-family:'Palatino Linotype', 'Book Antiqua', Palatino, serif;line-height:40px;font-weight:400;font-style:normal;font-size:38px;}h2{font-family:'Bookman Old Style', serif;line-height:40px;font-weight:normal;font-style:normal;font-size:32px;}h3{font-family:'Bookman Old Style', serif;line-height:30px;font-weight:400;font-style:normal;font-size:24px;}h4{font-family:'Bookman Old Style', serif;line-height:25px;font-weight:400;font-style:normal;font-size:20px;}h5{font-family:'Bookman Old Style', serif;line-height:24px;font-weight:700;font-style:normal;font-size:18px;}body{font-family:'MS Serif', 'New York', sans-serif;line-height:20px;font-weight:400;font-style:normal;font-size:14px;}#nav-main ul.sf-menu a{font-family:Lato;line-height:18px;font-weight:400;font-style:normal;font-size:12px;}#nav-second ul.sf-menu a{font-family:Lato;line-height:22px;font-weight:400;font-style:normal;font-size:18px;}.kad-nav-inner .kad-mnav, .kad-mobile-nav .kad-nav-inner li a,.nav-trigger-case{font-family:Lato;line-height:20px;font-weight:400;font-style:normal;font-size:16px;}</style></head>
  <body class="single single-post postid-61 single-format-standard wide morans-i-calculation-and-testing">
    <div id="wrapper" class="container">
    <div id="kt-skip-link"><a href="#content">Skip to Main Content</a></div><header class="banner headerclass" role="banner">
  <section id="topbar" class="topclass">
    <div class="container">
      <div class="row">
        <div class="col-md-6 col-sm-6 kad-topbar-left">
          <div class="topbarmenu clearfix">
          <ul id="menu-site-links" class="sf-menu"><li  class="menu-home menu-item-297"><a href="http://quanteco.github.io./">Home</a></li>
<li  class="menu-research menu-item-296"><a href="http://quanteco.github.io./research/">Research</a></li>
<li  class="menu-eportfolio menu-item-295"><a href="http://quanteco.github.io./eportfolio/">ePortfolio</a></li>
<li  class="menu-blog-on-quantitative-ecology current_page_parent menu-item-323"><a href="http://quanteco.github.io./blog-on-quantitative-ecology/">Blog on Quantitative Ecology</a></li>
<li  class="menu-curriculum-vitae menu-item-325"><a href="http://quanteco.github.io./curriculum-vitae/">Curriculum Vitae</a></li>
<li  class="menu-contact menu-item-324"><a href="http://quanteco.github.io./contact/">Contact</a></li>
</ul>                                  </div>
        </div><!-- close col-md-6 --> 
        <div class="col-md-6 col-sm-6 kad-topbar-right">
          <div id="topbar-search" class="topbar-widget">
            <form role="search" method="get" id="searchform" class="form-search" action="http://quanteco.github.io./">
  <label class="hide" for="s">Search for:</label>
  <input type="text" value="" name="s" id="s" class="search-query" placeholder="Search">
  <button type="submit" id="searchsubmit" class="search-icon"><i class="icon-search"></i></button>
</form>        </div>
        </div> <!-- close col-md-6-->
      </div> <!-- Close Row -->
    </div> <!-- Close Container -->
  </section>
  <div class="container">
    <div class="row">
          <div class="col-md-4 clearfix kad-header-left">
            <div id="logo" class="logocase">
              <a class="brand logofont" href="http://quanteco.github.io./">
                              </a>
                         </div> <!-- Close #logo -->
       </div><!-- close logo span -->
              
    </div> <!-- Close Row -->
     
  </div> <!-- Close Container -->
   
     </header>      <div class="wrap contentclass" role="document">

          <div id="content" class="container">
    <div class="row single-article" itemscope="" itemtype="http://schema.org/BlogPosting">
      <div class="main col-lg-9 col-md-8" role="main">
                  <article class="post-61 post type-post status-publish format-standard has-post-thumbnail hentry category-r tag-autocorrelation tag-dbmem tag-mem tag-morans-i">
                                  <div class="imghoverclass postfeat post-single-img" itemprop="image">
                        <a href="http://quanteco.github.io./wp-content/uploads/2015/01/moransi.png" data-rel="lightbox" class="lightboxhover">
                          <img src="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/moransi.png?resize=600%2C600" itemprop="image" alt="Moran&#8217;s I (Calculation and Testing)" />
                        </a>
                      </div>
                                <div class="postmeta updated">
      <div class="postdate bg-lightgray headerfont" itemprop="datePublished">
      <span class="postday">29</span>
      Dec 2015    </div>
</div> 
    <header>
      <h1 class="entry-title" itemprop="name headline">Moran&#8217;s I (Calculation and Testing)</h1>
      <div class="subhead">
    <span class="postauthortop author vcard">
    <i class="icon-user"></i> by  <span itemprop="author"><a href="http://quanteco.github.io./author/quanteco/" class="fn" rel="author">quanteco</a></span> |</span>
      
    <span class="postedintop"><i class="icon-folder-open"></i> posted in: <a href="http://quanteco.github.io./category/r/" rel="category tag">R</a></span>     <span class="kad-hidepostedin">|</span>
    <span class="postcommentscount">
    <i class="icon-comments-alt"></i> 0    </span>
</div>  
    </header>
    <div class="entry-content" itemprop="description articleBody">
      <p>In tandem with the <a title="Developing Distance Based Neighborhood Matrices" href="http://www.gregbanderson.com/?p=41">previous post</a>, this blog post will focus on calculating Moran’s I and testing for autocorrelation. Moran&#8217;s I is a value that represents the degree of autocorrelation in a vector (<img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x} " title="&#92;mathbf{x} " class="latex" />) given a weight matrix (<img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7BW%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{W}" title="&#92;mathbf{W}" class="latex" />) or a neighborhood matrix. &lt;!–more–&gt;It is similar to calculating the correlation between two variables and is typically restricted to be between -1 and 1; however, this depends on whether the weight matrix is weighted by row. Negative values of Moran&#8217;s I represent negative autocorrelation and positive values represent positive autocorrelation. Although these values can be compared to the spatial autocorrelation of other vectors, there is little utility of the Moran&#8217;s I value itself. Therefore, we need to develop an approach to calculate whether this value is larger (or smaller) than expected by chance. To do that, we will develop two functions in this post: one to calculate Moran&#8217;s I and one to perform a permutation/randomization test to calculate an empirical <img src="//s0.wp.com/latex.php?latex=p+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="p " title="p " class="latex" /> value.</p>
<p>The first step is to develop a function to calculate Moran’s I. Because this function will be eventually incorporated into the permutation test procedure, it is best to write the function with matrix algebra:</p>
<p style="text-align: center;"><img src="//s0.wp.com/latex.php?latex=%5Cfrac%7Bn%7D%7B%5Cmathbf%7Bj%7D%5ET%5Cmathbf%7BWj%7D%7D%5Cfrac%7B%5Cmathbf%7Bx%7D%5ET%28%5Cmathbf%7BI%7D-%5Cmathbf%7Bjj%7D%5ET%2Fn%29%5Cmathbf%7BW%7D%28%5Cmathbf%7BI%7D-%5Cmathbf%7Bjj%7D%5ET%2Fn%29%5Cmathbf%7Bx%7D%7D%7B%5Cmathbf%7Bx%7D%5ET%28%5Cmathbf%7BI%7D-%5Cmathbf%7Bjj%7D%5ET%2Fn%29%5Cmathbf%7Bx%7D%7D&#038;bg=ffffff&#038;fg=000&#038;s=3" alt="&#92;frac{n}{&#92;mathbf{j}^T&#92;mathbf{Wj}}&#92;frac{&#92;mathbf{x}^T(&#92;mathbf{I}-&#92;mathbf{jj}^T/n)&#92;mathbf{W}(&#92;mathbf{I}-&#92;mathbf{jj}^T/n)&#92;mathbf{x}}{&#92;mathbf{x}^T(&#92;mathbf{I}-&#92;mathbf{jj}^T/n)&#92;mathbf{x}}" title="&#92;frac{n}{&#92;mathbf{j}^T&#92;mathbf{Wj}}&#92;frac{&#92;mathbf{x}^T(&#92;mathbf{I}-&#92;mathbf{jj}^T/n)&#92;mathbf{W}(&#92;mathbf{I}-&#92;mathbf{jj}^T/n)&#92;mathbf{x}}{&#92;mathbf{x}^T(&#92;mathbf{I}-&#92;mathbf{jj}^T/n)&#92;mathbf{x}}" class="latex" />,</p>
<p style="text-align: left;">where <img src="//s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="n" title="n" class="latex" /> is the number of elements in the vector <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" /> (the vector to be tested for autocorrelation), <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bj%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{j}" title="&#92;mathbf{j}" class="latex" /> is a vector of ones equal to the length of <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" />, <img src="//s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="T" title="T" class="latex" /> represents the transpose of a matrix of vector, and <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7BW%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{W}" title="&#92;mathbf{W}" class="latex" /> is the weight matrix or neighborhood matrix.</p>
<p style="text-align: left;">To implement this in R we need to write a function with two arguments: a vector object for <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" /> and a matrix object for <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7BW%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{W}" title="&#92;mathbf{W}" class="latex" />. In the script below, I calculate Moran’s I, but I break the function down for easier coding:</p>
<p style="text-align: left;">
<pre class="brush: r; title: ; notranslate" title="">
morans.I&lt;-function(X,W){
  n&lt;-length(X)
  I&lt;-diag(n)
  J&lt;-rep(1,n)
  H&lt;-I-J%*%t(J)/n
  morans&lt;-(n/(t(J)%*%W%*%J))%*%((t(X)%*%H%*%W%*%H%*%X)/(t(X)%*%H%*%X))
  return(as.vector(morans))
}</pre>
<div class="wp-git-embed" style="margin-bottom:10px; border:1px solid #CCC; text-align:right; width:99%; margin-top:-13px; font-size:11px; font-style:italic;"><span style="display:inline-block; padding:4px;">moransi.R</span><a style="display:inline-block; padding:4px 6px;" href="https://raw.github.com/quanteco/quanteco/master/R/moransi.R#L23" target="_blank">view raw</a><a style="display:inline-block; padding:4px 6px; float:left;" href="https://github.com/quanteco/quanteco/blob/master/R/moransi.R#L23" target="_blank">view file on <strong>GitHub</strong></a></div>
</p>
<p style="text-align: left;">With this function at hand, doing a monte-carlo test (i.e., randomization test) is fairly simple. However, we might also want a way to do permutations when <img src="//s0.wp.com/latex.php?latex=n+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="n " title="n " class="latex" /> is small; luckily the <em>combinat</em> package has a function we can use. Since our <em>morans.test</em> function will use the <em>morans.i</em> function, the arguments for our function need to include a vector of values to use (i.e., <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x} " title="&#92;mathbf{x} " class="latex" />) and a weight matrix (i.e., <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7BW%7D+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{W} " title="&#92;mathbf{W} " class="latex" />). Along with these arguments we can include a few more things: the number of rearrangements to do (N) on the <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" /> vector and whether we want to do a test for :(1) positive autocorrelation, (2) negative autocorrelation, (3) or both (i.e., two-sided). I will also include two logical arguments for whether or not to graph a density plot of the rearrangements or whether the results should be printed (i.e., the function can be performed in a silent mode).</p>
<pre class="brush: r; title: ; notranslate" title="">
morans.test&lt;-function(X,W,N=999,test=c(&quot;positive&quot;,&quot;negative&quot;,&quot;two-sided&quot;),
   graph=F,print.results=T){
</pre>
<p>The first part of the function needs to utilize the <em>moran.i</em> function above to calculate the observed value for the vector. We then need to create N rearrangements of the vector <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" /> and calculate Moran&#8217;s I for each of them. Depending on the length of the vector, these rearrangements will be either permutations or randomizations.</p>
<pre class="brush: r; title: ; notranslate" title="">
writeLines(&quot;Moran's I test for Autocorrelation&quot;)
require(pbapply)
observed&lt;-morans.I(X,W)
options(&quot;pbapply.pb&quot;=&quot;txt&quot;)
if(length(X)&lt;8){
 if(N&gt;gamma(length(X)+1))writeLines(paste(&quot;Only&quot;,gamma(length(X)+1),&quot;permutations
  were used due to small sample size&quot;))
 require(combinat)
 store&lt;-pbapply(array(unlist(permn(X)),dim=c(length(X),gamma(length(X)+1)))[,
  1:(ifelse(N&lt;=gamma(length(X)+1),N,gamma(length(X)+1)))],2,function(x)morans.I(x,W))
}
 else store&lt;-pbapply(replicate(N,sample(X)),2,function(x)morans.I(x,W))
</pre>
<p>Above I have used the library <em>pbapply</em> to calculate Moran&#8217;s I for either the permutations or randomizations of the vector <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" />. The function <em>pbapply</em> essenstially performs the same task as <em>apply</em>, but the function gives us a progress bar, which can be helpful when N is large. I should also note the use of the function <em>replicate</em> and <em>sample</em> to create the randomizations when <img src="//s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="n" title="n" class="latex" /> is greater than 8. The function <em>sample</em>, simply rearranges the items of <img src="//s0.wp.com/latex.php?latex=%5Cmathbf%7Bx%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;mathbf{x}" title="&#92;mathbf{x}" class="latex" />, and the function <em>replicate</em> simply asks R to replicate the function N times and return it as a matrix. We then can use this matrix within an <em>pbapply</em> function.  I also used the <em>permn</em> function from the library <em>combinat</em>. The function gives all the unique permutations of a vector, but the output is a list. I simply used the function <em>array</em> and <em>unlist</em> to covert this to a matrix with dimensions <img src="//s0.wp.com/latex.php?latex=n+times+k&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="n times k" title="n times k" class="latex" /> where <img src="//s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="k" title="k" class="latex" /> is found using the R function <em>gamma</em>.</p>
<p>Next, we need to use these Moran’s I values to calculate an empirical <img src="//s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="p" title="p" class="latex" />-value. The method on how to do this depends on whether the test is for positive autocorrelation, negative autocorrelation, or both (i.e., two sided). For the first two options of these, we just need to determine the proportion of values above or below the observed value. However, for the two-sided test, we need to subtract the mean of the Moran’s I from the rearrangements from the observed Moran’s I value and the value of Moran’s I from all the rearrangements. We can then calculate the <img src="//s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="p" title="p" class="latex" />-value in the same manner as the positive autocorrelation test. Additionally, I have added two lines that specify a default value and a stopping message if the test is specified incorrectly (e.g., not ‘positive’, ‘negative’, or ‘two-sided’)</p>
<pre class="brush: r; title: ; notranslate" title="">
 if(length(test)&gt;1){test=test[1]}
 if(test==&quot;positive&quot;){
 p.value&lt;-(sum(ifelse(store&gt;=observed,1,0))+1)/(length(store)+1)
 expected=(-1/(length(X)-1))
 }
 else if(test==&quot;negative&quot;){
 p.value&lt;-(sum(ifelse(store&lt;=observed,1,0))+1)/(length(store)+1)
 expected=(-1/(length(X)-1))
 }
 else if(test==&quot;two-sided&quot;){
 observed&lt;-abs(observed-mean(store))
 store&lt;-abs(store-mean(store))
 expected=abs(-1/(length(X)-1))
 p.value&lt;-(sum(ifelse(store&gt;=observed,1,0))+1)/(length(store)+1)
 }
 else{stop(&quot;test must be at 'positive', 'negative' or 'two-sided'&quot;)}
</pre>
<p>That is all we really need for the function. Below I have added a few more things. First, to visualize the results, I utilize the <em>ggplot2</em> package to print a graph. Second, in the case that the function is used in a wrapper, I have provided a silent function (print.results=F).</p>
<pre class="brush: r; title: ; notranslate" title="">
 if(graph==T){
 require(ggplot2)
 tmp.dat&lt;-data.frame(store=store,observed=observed)
 export.graph&lt;-ggplot(tmp.dat,aes(x=store))+
 scale_y_sqrt()+geom_density()+
 geom_vline(aes(xintercept=observed),color=&quot;red&quot;,size=1)+
 xlab(&quot;Moran's I Coefficient&quot;) +
 ylab(&quot;Empirical Density&quot;)+theme_bw(base_family=&quot;serif&quot;)
 print(export.graph)
 }
 if(print.results==T){
 print(list(Observed=observed,Expected=expected,p.value=p.value))
 }
 z&lt;-list(Observed=observed,Expected=expected,p.value=p.value,Values=store)
}
</pre>
<p>The full function from my <a href="https://github.com/quanteco/quanteco" target="_blank">quanteco github repository</a> is listed below. However, the utility function <em>morans.i</em> (found above) needs to be loaded first.</p>
<pre class="brush: r; title: ; notranslate" title="">morans.test&lt;-function(X,W,N=999,test=c(&quot;positive&quot;,&quot;negative&quot;,&quot;two-sided&quot;),graph=F,print.results=T){  
  writeLines(&quot;Moran's I test for Autocorrelation&quot;)
  require(pbapply)
  observed&lt;-morans.I(X,W)
  options(&quot;pbapply.pb&quot;=&quot;txt&quot;)
  if(length(X)&lt;8){
    if(N&gt;gamma(length(X)+1))writeLines(paste(&quot;Only&quot;,gamma(length(X)+1),&quot;permutations were used due to small sample size&quot;))
    require(combinat)
    store&lt;-pbapply(array(unlist(permn(X)),dim=c(length(X),gamma(length(X)+1)))[,1:(ifelse(N&lt;=gamma(length(X)+1),N,gamma(length(X)+1)))],2,function(x)morans.I(x,W))
  }
  else store&lt;-pbapply(replicate(N,sample(X)),2,function(x)morans.I(x,W))
  if(length(test)&gt;1){test=test[1]}
  if(test==&quot;positive&quot;){
    p.value&lt;-(sum(ifelse(store&gt;=observed,1,0))+1)/(length(store)+1)
    expected=(-1/(length(X)-1))  
  }
  else if(test==&quot;negative&quot;){
    p.value&lt;-(sum(ifelse(store&lt;=observed,1,0))+1)/(length(store)+1)
    expected=(-1/(length(X)-1))
  }
  else if(test==&quot;two-sided&quot;){
    observed&lt;-abs(observed-mean(store))
    store&lt;-abs(store-mean(store))
    expected=abs(-1/(length(X)-1))
    p.value&lt;-(sum(ifelse(store&gt;=observed,1,0))+1)/(length(store)+1)
  }
  else{stop(&quot;test must be at 'positive', 'negative' or 'two-sided'&quot;)}
  if(graph==T){
    require(ggplot2)
    tmp.dat&lt;-data.frame(store=store,observed=observed)
    export.graph&lt;-ggplot(tmp.dat,aes(x=store))+
      scale_y_sqrt()+geom_density()+
      geom_vline(aes(xintercept=observed),color=&quot;red&quot;,size=1)+
      xlab(&quot;Moran's I Coefficient&quot;) +
      ylab(&quot;Empirical Density&quot;)+theme_bw(base_family=&quot;serif&quot;)
    print(export.graph)
  }
  if(print.results==T){
    print(list(Observed=observed,Expected=expected,p.value=p.value))
  }
  z&lt;-list(Observed=observed,Expected=expected,p.value=p.value,Values=store)
}</pre>
<div class="wp-git-embed" style="margin-bottom:10px; border:1px solid #CCC; text-align:right; width:99%; margin-top:-13px; font-size:11px; font-style:italic;"><span style="display:inline-block; padding:4px;">moranstest.R</span><a style="display:inline-block; padding:4px 6px;" href="https://raw.github.com/quanteco/quanteco/master/R/moranstest.R#L28" target="_blank">view raw</a><a style="display:inline-block; padding:4px 6px; float:left;" href="https://github.com/quanteco/quanteco/blob/master/R/moranstest.R#L28" target="_blank">view file on <strong>GitHub</strong></a></div>
<p>Now to try the function out. The function can be copied and pasted into R or can be installed, along with other functions from this blog, using the following R commands:</p>
<pre class="brush: r; title: ; notranslate" title="">
install.packages(&quot;devtools&quot;)
library(devtools)
install_github(&quot;quanteco/quanteco&quot;)
library(quanteco)
</pre>
<p>To test the function, we first need to simulate some autocorrelated data. To do this we need to (1) develop a function to create autocorrelated data, (2) simulate a distance matrix, (3) run the distance matrix through the weight_matrix function developed in the previous post, (4) use the weighted matrix to force a vector of values to be autocorrelated, and (5) test for this autocorrelation with using Moran&#8217;s I.</p>
<p>Below I have developed a function to force a vector to be autocorrelated given rho and a weight matrix.</p>
<pre class="brush: r; title: ; notranslate" title="">
sim.autocorrelated&lt;-function(X,rho,W){
 n&lt;-length(X)
 e&lt;-eigen(W,only.values=TRUE)$values
 if (is.complex(e))
 feasible &lt;- 1/(range(Re(e)))
 else feasible &lt;- 1/(range(e))
 if (rho &lt;= feasible[1] || rho &gt;= feasible[2])
  stop(paste(&quot;Rho outside feasible range:&quot;, feasible))
 mat&lt;-diag(n)-rho * W
 res&lt;-chol2inv(chol(mat))
 return(res%*%X)
}
</pre>
<p>&nbsp;</p>
<p>Now we need to create a random vector (y) representing values taken from different sites and an associated distance matrix for all sites. For this I will utilize the Matrix library.</p>
<pre class="brush: r; title: ; notranslate" title="">
set.seed(200)
n&lt;-100
y&lt;-rnorm(n)
D&lt;-array(dim=rep(length(y),2))
diag(D)&lt;-0
D[lower.tri(D,diag=F)]&lt;-runif(length(D[lower.tri(D,diag=F)]),0,500)
library(Matrix)
D&lt;-forceSymmetric(D,uplo=&quot;L&quot;)
}
</pre>
<p>We can create a weight matrix using the weightmatrix function from the previous post.</p>
<pre class="brush: r; title: ; notranslate" title="">
W&lt;-weightmatrix(D)
y&lt;-sim.autocorrelated(y,0,0.1,W)
</pre>
<p>With this autocorrelated vector and the associated weight matrix, we can test for autocorrealtion using the morans.test function.</p>
<pre class="brush: r; light: true; title: ; notranslate" title="">
morans.test(y,W,graph=T)
</pre>
<p>Above I have specified to graph the results, which can be seen at the top of the post. By default we have run 999 randomizations and tested for positive autocorrelation.</p><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-61" class="share-twitter sd-button share-icon no-text" href="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/?share=twitter" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-61" class="share-facebook sd-button share-icon no-text" href="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/?share=facebook" target="_blank" title="Share on Facebook"><span></span><span class="sharing-screen-reader-text">Share on Facebook (Opens in new window)</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-61" class="share-google-plus-1 sd-button share-icon no-text" href="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/?share=google-plus-1" target="_blank" title="Click to share on Google+"><span></span><span class="sharing-screen-reader-text">Click to share on Google+ (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>    </div>
    <footer class="single-footer">
              <span class="posttags"><i class="icon-tag"></i> <a href="http://quanteco.github.io./tag/autocorrelation/" rel="tag">autocorrelation</a>, <a href="http://quanteco.github.io./tag/dbmem/" rel="tag">dbmem</a>, <a href="http://quanteco.github.io./tag/mem/" rel="tag">mem</a>, <a href="http://quanteco.github.io./tag/morans-i/" rel="tag">Moran's I</a> </span>
                                  </footer>
    

  <section id="respond">
  				<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2015/12/29/morans-i-calculation-and-testing/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://quanteco.github.io./wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
					<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" class="input-xlarge" aria-required="true" required="required"></textarea></p><div class="row"><div class="col-md-4"><label for="author">Name <span class="comment-required">*</span></label> <input id="author" name="author" type="text" value="" aria-required="true" /></div>
<div class="col-md-4"><label for="email">Email (will not be published) <span class="comment-required">*</span></label> <input type="email" class="text" name="email" id="email" value="" aria-required="true" /></div>
<div class="col-md-4"><label for="url">Website</label> <input id="url" name="url" type="url" value="" /></div>
</div><p class="form-submit"><input name="submit" type="submit" id="submit" class="kad-btn kad-btn-primary" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='61' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="1011f130ee" /></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="21"/></p>				</form>
					</div><!-- #respond -->
		
  </section><!-- /#respond -->
  </article>
</div>

            
                      <aside class="col-lg-3 col-md-4 kad-sidebar" role="complementary">
              <div class="sidebar">
                     <section id="virtue_about_with_image-3" class="widget-1 widget-first widget virtue_about_with_image"><div class="widget-inner">    <div class="kad_img_upload_widget">
        <a href="http://quanteco.github.io./wp-content/uploads/2015/01/gregwinter2.jpg" rel="lightbox">        <img src="http://quanteco.github.io./wp-content/uploads/2015/01/gregwinter2.jpg" />
        </a>            </div>

    </div></section>    <section id="text-3" class="widget-2 widget widget_text"><div class="widget-inner"><h3>Gregory B. Anderson</h3>			<div class="textwidget">Dept. of Fish and Wildlife Conservation
Virginia Polytechnic Institute and State University
Blacksburg, VA 24061</div>
		</div></section><section id="nav_menu-3" class="widget-3 widget widget_nav_menu"><div class="widget-inner"><h3>Site Links</h3><ul id="menu-site-links-1" class="menu"><li  class="menu-home menu-item-297"><a href="http://quanteco.github.io./">Home</a></li>
<li  class="menu-research menu-item-296"><a href="http://quanteco.github.io./research/">Research</a></li>
<li  class="menu-eportfolio menu-item-295"><a href="http://quanteco.github.io./eportfolio/">ePortfolio</a></li>
<li  class="menu-blog-on-quantitative-ecology current_page_parent menu-item-323"><a href="http://quanteco.github.io./blog-on-quantitative-ecology/">Blog on Quantitative Ecology</a></li>
<li  class="menu-curriculum-vitae menu-item-325"><a href="http://quanteco.github.io./curriculum-vitae/">Curriculum Vitae</a></li>
<li  class="menu-contact menu-item-324"><a href="http://quanteco.github.io./contact/">Contact</a></li>
</ul></div></section>    <section id="kadence_recent_posts-3" class="widget-4 widget kadence_recent_posts"><div class="widget-inner">    <h3>Recent Posts</h3>    <ul>
        <li class="clearfix postclass">
        <a href="http://quanteco.github.io./2016/01/05/testing-site-and-time-contributions-to-variance-in-spatiotemporal-counts/" title="Testing Site and Time Contributions to Variance in Spatiotemporal Counts" class="recentpost_featimg">
          <img width="80" height="50" src="http://i1.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/propvar.png?resize=80%2C50" class="attachment-widget-thumb size-widget-thumb wp-post-image" alt="propvar" /></a>
        <a href="http://quanteco.github.io./2016/01/05/testing-site-and-time-contributions-to-variance-in-spatiotemporal-counts/" title="Testing Site and Time Contributions to Variance in Spatiotemporal Counts" class="recentpost_title">Testing Site and Time Contributions to Variance in Spatiotemporal Counts</a>
        <span class="recentpost_date">January 5, 2016</span>
        </li>
        <li class="clearfix postclass">
        <a href="http://quanteco.github.io./2016/01/04/morans-eigenvector-maps/" title="Moran&#8217;s Eigenvector Maps" class="recentpost_featimg">
          <img width="80" height="50" src="http://i1.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/autopatterns.png?resize=80%2C50" class="attachment-widget-thumb size-widget-thumb wp-post-image" alt="autopatterns" /></a>
        <a href="http://quanteco.github.io./2016/01/04/morans-eigenvector-maps/" title="Moran&#8217;s Eigenvector Maps" class="recentpost_title">Moran&#8217;s Eigenvector Maps</a>
        <span class="recentpost_date">January 4, 2016</span>
        </li>
        <li class="clearfix postclass">
        <a href="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/" title="Moran&#8217;s I (Calculation and Testing)" class="recentpost_featimg">
          <img width="80" height="50" src="http://i0.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/moransi.png?resize=80%2C50" class="attachment-widget-thumb size-widget-thumb wp-post-image" alt="moransi" /></a>
        <a href="http://quanteco.github.io./2015/12/29/morans-i-calculation-and-testing/" title="Moran&#8217;s I (Calculation and Testing)" class="recentpost_title">Moran&#8217;s I (Calculation and Testing)</a>
        <span class="recentpost_date">December 29, 2015</span>
        </li>
        <li class="clearfix postclass">
        <a href="http://quanteco.github.io./2015/12/15/developing-distance-based-neighborhood-matrices/" title="Developing Distance Based Neighborhood Matrices" class="recentpost_featimg">
          <img width="80" height="50" src="http://i1.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/neighborhood.png?resize=80%2C50" class="attachment-widget-thumb size-widget-thumb wp-post-image" alt="neighborhood" /></a>
        <a href="http://quanteco.github.io./2015/12/15/developing-distance-based-neighborhood-matrices/" title="Developing Distance Based Neighborhood Matrices" class="recentpost_title">Developing Distance Based Neighborhood Matrices</a>
        <span class="recentpost_date">December 15, 2015</span>
        </li>
        <li class="clearfix postclass">
        <a href="http://quanteco.github.io./2015/12/01/pastehelloworld/" title="paste(&#8220;Hello&#8221;,&#8221;World&#8221;)" class="recentpost_featimg">
          <img width="80" height="50" src="http://i2.wp.com/gregorybanderson.elementfx.com/wp-content/uploads/2015/01/helloworld.png?resize=80%2C50" class="attachment-widget-thumb size-widget-thumb wp-post-image" alt="helloworld" /></a>
        <a href="http://quanteco.github.io./2015/12/01/pastehelloworld/" title="paste(&#8220;Hello&#8221;,&#8221;World&#8221;)" class="recentpost_title">paste(&#8220;Hello&#8221;,&#8221;World&#8221;)</a>
        <span class="recentpost_date">December 1, 2015</span>
        </li>
        </ul>
    </div></section><section id="nav_menu-4" class="widget-5 widget widget_nav_menu"><div class="widget-inner"><h3>Recent Papers</h3><ul id="menu-recent-papers" class="menu"><li  class="menu-multi-scale-occupancy-models-to-infer-host-and-site-occupancy menu-item-344"><a href="http://www.sciencedirect.com/science/article/pii/S0380133015000039">Multi-scale Occupancy Models to Infer Host and Site Occupancy</a></li>
<li  class="menu-round-gobies-and-the-ecology-of-vhsv-genotype-ivb menu-item-306"><a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S0380133014001853">Round Gobies and the Ecology of VHSV Genotype IVb</a></li>
<li  class="menu-dealing-with-uncertainty-in-fish-passage menu-item-298"><a target="_blank" href="http://link.springer.com/article/10.1007%2Fs00267-012-9886-6">Dealing with Uncertainty in Fish Passage</a></li>
<li  class="menu-cyprinid-herpesvirus-3-in-the-great-lakes menu-item-299"><a target="_blank" href="http://www.jwildlifedis.org/doi/abs/10.7589/2012-02-062">Cyprinid Herpesvirus-3 in the Great Lakes</a></li>
<li  class="menu-occupancy-estimation-of-holiday-darter menu-item-300"><a target="_blank" href="http://www.tandfonline.com/doi/abs/10.1080/00028487.2011.644193">Occupancy Estimation of Holiday Darter</a></li>
</ul></div></section><section id="nav_menu-5" class="widget-6 widget widget_nav_menu"><div class="widget-inner"><h3>ePortfolio</h3><ul id="menu-eportfolio" class="menu"><li  class="menu-cirrus-clouds-and-classification menu-item-301"><a href="index.php?page_id=13/#cirrus">Cirrus Clouds and Classification</a></li>
<li  class="menu-autocorrelation-in-baci-designs menu-item-302"><a href="index.php?page_id=13/#baci">Autocorrelation in BACI Designs</a></li>
<li  class="menu-fluvial-geostatistical-sdm menu-item-303"><a href="index.php?page_id=13/#geostat">Fluvial Geostatistical SDM</a></li>
<li  class="menu-flow-path-direction-models menu-item-304"><a href="index.php?page_id=13/#dflow">Flow Path Direction Models</a></li>
<li  class="menu-multi-species-sdm menu-item-305"><a href="index.php?page_id=13/#community">Multi-species SDM</a></li>
</ul></div></section><section id="categories-4" class="widget-7 widget widget_categories"><div class="widget-inner"><h3>Categories</h3>		<ul>
	<li class="cat-item cat-item-2"><a href="http://quanteco.github.io./category/hello/" >Hello</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://quanteco.github.io./category/r/" >R</a>
</li>
		</ul>
</div></section><section id="widget_profile-3" class="widget-8 widget-last widget widget_widget_profile"><div class="widget-inner"><h3>Github</h3><div class="wpgithub-profile"><div class="wpgithub-user"><a href="https://github.com/quanteco" title="View quanteco's Github"><img src="http://gravatar.com/avatar/?s=56" alt="View quanteco's Github" /></a><h3 class="wpgithub-username"><a href="https://github.com/quanteco" title="View quanteco's Github">quanteco</a></h3><p class="wpgithub-name">Gregory Anderson</p><p class="wpgithub-location">Blacksburg, VA</p></div><a class="wpgithub-bblock" href="https://github.com/quanteco?tab=repositories"><span class="wpgithub-count">4</span><span class="wpgithub-text">Public Repos</span></a><a class="wpgithub-bblock" href="https://gist.github.com/quanteco"><span class="wpgithub-count">0</span><span class="wpgithub-text">Public Gists</span></a><a class="wpgithub-bblock" href="https://github.com/quanteco/followers"><span class="wpgithub-count">0</span><span class="wpgithub-text">Followers</span></a></div></div></section>              </div><!-- /.sidebar -->
            </aside><!-- /aside -->
                    </div><!-- /.row-->
        </div><!-- /.content -->
      </div><!-- /.wrap -->
      <footer id="containerfooter" class="footerclass" role="contentinfo">
  <div class="container">
  	<div class="row">
  								        			        </div>
        <div class="footercredits clearfix">
    		
    		        	<p>&copy; 2016 Gregory B. Anderson. All Rights Reserved.</p>
    	</div>

  </div>

</footer>

	<div style="display:none">
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/gregorybanderson.elementfx.com\/2015\/12\/29\/morans-i-calculation-and-testing\/":61};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/akismet/_inc/form.js?ver=3.1.7'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushR.js?ver=20100919'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://quanteco.github.io./wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://quanteco.github.io./wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/resume-builder/js/jquery.raty.js?ver=1.0'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/resume-builder/js/functions.js?ver=1.0'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201613'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2016Apraa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.4.2'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-includes/js/comment-reply.min.js?ver=4.4.2'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-includes/js/masonry.min.js?ver=3.1.2'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/themes/virtue/assets/js/min/plugins-min.js?ver=262'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/themes/virtue/assets/js/main.js?ver=262'></script>
<script type='text/javascript' src='http://quanteco.github.io./wp-includes/js/wp-embed.min.js?ver=4.4.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='http://quanteco.github.io./wp-content/plugins/jetpack/modules/sharedaddy/sharing.js?ver=3.8.2'></script>
<script type='text/javascript' src='http://stats.wp.com/e-201613.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.8.2',blog:'104885985',post:'61',tz:'0',srv:'gregorybanderson.elementfx.com'} ]);
	_stq.push([ 'clickTrackerInit', '104885985', '61' ]);
</script>
    </div><!--Wrapper-->
  </body>
</html>
